{"ast":null,"code":"import RRule, { DEFAULT_OPTIONS } from './rrule';\nimport { includes, isPresent, isArray, isNumber, toArray } from './helpers';\nimport { Weekday } from './weekday';\nimport dateutil from './dateutil';\nimport { DateWithZone } from './datewithzone';\nexport function optionsToString(options) {\n  var rrule = [];\n  var dtstart = '';\n  var keys = Object.keys(options);\n  var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n\n  for (var i = 0; i < keys.length; i++) {\n    if (keys[i] === 'tzid') continue;\n    if (!includes(defaultKeys, keys[i])) continue;\n    var key = keys[i].toUpperCase();\n    var value = options[keys[i]];\n    var outValue = '';\n    if (!isPresent(value) || isArray(value) && !value.length) continue;\n\n    switch (key) {\n      case 'FREQ':\n        outValue = RRule.FREQUENCIES[options.freq];\n        break;\n\n      case 'WKST':\n        if (isNumber(value)) {\n          outValue = new Weekday(value).toString();\n        } else {\n          outValue = value.toString();\n        }\n\n        break;\n\n      case 'BYWEEKDAY':\n        /*\n        NOTE: BYWEEKDAY is a special case.\n        RRule() deconstructs the rule.options.byweekday array\n        into an array of Weekday arguments.\n        On the other hand, rule.origOptions is an array of Weekdays.\n        We need to handle both cases here.\n        It might be worth change RRule to keep the Weekdays.\n               Also, BYWEEKDAY (used by RRule) vs. BYDAY (RFC)\n               */\n        key = 'BYDAY';\n        outValue = toArray(value).map(function (wday) {\n          if (wday instanceof Weekday) {\n            return wday;\n          }\n\n          if (isArray(wday)) {\n            return new Weekday(wday[0], wday[1]);\n          }\n\n          return new Weekday(wday);\n        }).toString();\n        break;\n\n      case 'DTSTART':\n        dtstart = buildDtstart(value, options.tzid);\n        break;\n\n      case 'UNTIL':\n        outValue = dateutil.timeToUntilString(value, !options.tzid);\n        break;\n\n      default:\n        if (isArray(value)) {\n          var strValues = [];\n\n          for (var j = 0; j < value.length; j++) {\n            strValues[j] = String(value[j]);\n          }\n\n          outValue = strValues.toString();\n        } else {\n          outValue = String(value);\n        }\n\n    }\n\n    if (outValue) {\n      rrule.push([key, outValue]);\n    }\n  }\n\n  var rules = rrule.map(function (_a) {\n    var key = _a[0],\n        value = _a[1];\n    return key + \"=\" + value.toString();\n  }).join(';');\n  var ruleString = '';\n\n  if (rules !== '') {\n    ruleString = \"RRULE:\" + rules;\n  }\n\n  return [dtstart, ruleString].filter(function (x) {\n    return !!x;\n  }).join('\\n');\n}\n\nfunction buildDtstart(dtstart, tzid) {\n  if (!dtstart) {\n    return '';\n  }\n\n  return 'DTSTART' + new DateWithZone(new Date(dtstart), tzid).toString();\n}","map":{"version":3,"mappings":"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","names":["RRule","DEFAULT_OPTIONS","includes","isPresent","isArray","isNumber","toArray","Weekday","dateutil","DateWithZone","optionsToString","options","rrule","dtstart","keys","Object","defaultKeys","i","length","key","toUpperCase","value","outValue","FREQUENCIES","freq","toString","map","wday","buildDtstart","tzid","timeToUntilString","strValues","j","String","push","rules","_a","join","ruleString","filter","x","Date"],"sources":["../../../src/optionstostring.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}